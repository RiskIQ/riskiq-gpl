package com.riskiq.core.net;

import java.io.ByteArrayInputStream;
import java.security.cert.X509Certificate;
import org.junit.Test;
import static org.junit.Assert.*;

public class RiqX509CertImplTest {

    @Test
    public void testCertWithoutDN() throws Exception {
        byte[] der = new byte[]{48, -126, 2, -79, 48, -126, 2, 54, -96, 3, 2, 1, 2, 2, 17, 0, -56, -86, -97, 64, 75,
                -53, 127, 124, 32, 82, 48, -78, -79, 54, -128, -105, 48, 10, 6, 8, 42, -122, 72, -50, 61, 4, 3, 3, 48,
                0, 48, 30, 23, 13, 50, 49, 49, 48, 49, 53, 49, 56, 51, 50, 53, 53, 90, 23, 13, 50, 52, 49, 48, 49, 52,
                49, 56, 51, 50, 53, 53, 90, 48, 104, 49, 11, 48, 9, 6, 3, 85, 4, 6, 19, 2, 85, 83, 49, 9, 48, 7, 6, 3,
                85, 4, 8, 19, 0, 49, 9, 48, 7, 6, 3, 85, 4, 7, 19, 0, 49, 9, 48, 7, 6, 3, 85, 4, 9, 19, 0, 49, 13, 48,
                11, 6, 3, 85, 4, 17, 19, 4, 49, 52, 53, 52, 49, 21, 48, 19, 6, 3, 85, 4, 10, 19, 12, 112, 97, 114, 116,
                110, 101, 114, 115, 32, 108, 116, 100, 49, 18, 48, 16, 6, 3, 85, 4, 3, 19, 9, 108, 111, 99, 97, 108,
                104, 111, 115, 116, 48, -126, 1, 34, 48, 13, 6, 9, 42, -122, 72, -122, -9, 13, 1, 1, 1, 5, 0, 3, -126,
                1, 15, 0, 48, -126, 1, 10, 2, -126, 1, 1, 0, -46, -16, -93, -11, -60, -92, 89, -32, -125, -123, 10,
                -41, 38, 53, 14, 121, 79, -24, 59, 7, 107, 68, -25, 84, -110, -2, -66, -76, -30, 113, -108, 11, 61,
                115, 43, 8, -80, 114, -11, -84, 54, 62, 58, -113, -38, 89, 103, 103, 73, 81, 49, 23, 59, -90, -48, -88,
                89, -116, 95, 86, 28, -12, -48, -33, 96, 67, 57, 121, -32, 32, -117, 94, -108, 2, 104, -33, -5, -11,
                25, -58, -75, 14, -58, 39, -100, 67, -66, 4, -66, 50, 27, -74, -112, -117, -75, -2, 124, -112, 117, -83,
                -115, -114, -89, -17, 120, -46, -15, -7, 48, -30, 87, 43, -56, 26, -107, 18, -13, 101, 94, 122, -77,
                -42, -36, 43, 18, -70, -71, -96, -92, 20, -34, 65, 83, 25, -52, 17, -41, -27, -64, -115, -2, -72, 13,
                98, -78, -75, -29, -104, -31, 25, -8, -51, -71, 6, -21, -119, -64, -103, -78, -105, 90, 85, 102, 85,
                -12, -34, -66, -7, -46, 95, -119, -49, 81, -60, -122, -60, 102, -96, 26, 1, 72, -76, -73, 92, -47, 26,
                -4, 46, 5, -118, -82, 96, 76, -27, 1, 56, 14, 60, 37, 39, 88, 11, 56, 9, 40, 55, -62, -17, 127, 40,
                -106, 85, 97, -33, -100, -75, 124, -123, 32, 18, -50, 123, 79, -2, -87, 19, -52, -45, -120, -62, -111,
                57, -11, 5, -108, -65, -21, -103, 63, -11, -2, 77, -57, 115, -84, -58, -103, -106, 43, -13, 35, -95,
                -109, -104, 71, 111, 2, 3, 1, 0, 1, -93, 94, 48, 92, 48, 14, 6, 3, 85, 29, 15, 1, 1, -1, 4, 4, 3, 2, 5,
                -96, 48, 19, 6, 3, 85, 29, 37, 4, 12, 48, 10, 6, 8, 43, 6, 1, 5, 5, 7, 3, 1, 48, 31, 6, 3, 85, 29, 35,
                4, 24, 48, 22, -128, 20, 87, 122, 40, -52, -21, -120, -58, 87, -67, 97, 89, -62, 25, 14, 12, -85, 50,
                114, -107, 90, 48, 20, 6, 3, 85, 29, 17, 4, 13, 48, 11, -126, 9, 108, 111, 99, 97, 108, 104, 111, 115,
                116, 48, 10, 6, 8, 42, -122, 72, -50, 61, 4, 3, 3, 3, 105, 0, 48, 102, 2, 49, 0, -26, 82, -121, -94,
                -91, 47, 108, 20, -7, 19, -119, 75, 55, -107, -29, 74, -69, 9, -94, -12, 37, -96, -36, 3, 88, 38, 10,
                -109, 13, 36, -75, 80, -127, 6, 29, -28, -46, 61, -97, 53, 97, -21, 7, -82, -40, 21, 45, 118, 2, 49, 0,
                -40, -47, 59, 52, -10, -61, -35, 48, -92, 44, -43, 46, 56, 56, 121, -13, -107, -3, 87, 43, -69, 59, -17,
                -21, -78, -17, 69, -31, 13, -65, -101, 76, 96, 117, -47, -6, -79, 35, 24, 97, -13, 47, 32, 121, 85,
                -125, 34, 9};
        X509Certificate cert = new RiqX509CertImpl(new ByteArrayInputStream(der));
        assertTrue(cert.getSubjectDN().getName().contains("localhost"));
    }
}
